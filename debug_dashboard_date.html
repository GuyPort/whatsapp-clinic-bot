<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug Dashboard Date</title>
</head>
<body>
    <h1>Debug: Teste de Formatação de Data no Dashboard</h1>
    <div id="result"></div>

    <script>
        // Função EXATA do dashboard
        function formatDate(dateStr) {
            console.log('=== FORMATDATE DEBUG ===');
            console.log('1. Input dateStr:', dateStr, 'Type:', typeof dateStr);
            
            const parts = dateStr.split('/');
            console.log('2. Parts after split:', parts);
            
            if (parts.length === 3) {
                const [day, month, year] = parts;
                console.log('3. Extracted - Day:', day, 'Month:', month, 'Year:', year);
                
                // IMPORTANTE: Month é 0-indexed em JavaScript (0 = Janeiro)
                const date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));
                console.log('4. Date object created:', date);
                console.log('5. Date.toString():', date.toString());
                console.log('6. Is valid (isNaN test):', !isNaN(date.getTime()));
                console.log('7. getTime():', date.getTime());
                
                if (!isNaN(date.getTime())) {
                    const formatted = date.toLocaleDateString('pt-BR', {
                        weekday: 'short',
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric'
                    });
                    console.log('8. Formatted result:', formatted);
                    return formatted;
                }
            }
            console.log('9. Fallback: returning original dateStr');
            return dateStr;
        }

        // Simular o que a API retorna
        const apiResponse = {
            "id": 27,
            "patient_name": "Guylhermy Port",
            "patient_phone": "555196181683",
            "patient_birth_date": "07/08/2003",
            "appointment_date": "27/10/2025",  // O que deveria vir da API
            "appointment_time": "14:45",
            "status": "agendada",
            "duration_minutes": 60
        };

        console.log('\n=== TESTE 1: Com data formatada da API ===');
        const result1 = formatDate(apiResponse.appointment_date);
        
        console.log('\n=== TESTE 2: Com data YYYYMMDD (formato banco) ===');
        const result2 = formatDate('20251027');
        
        document.getElementById('result').innerHTML = `
            <h2>Resultados:</h2>
            <p><strong>Teste 1 (DD/MM/YYYY):</strong></p>
            <p>Input: "${apiResponse.appointment_date}"</p>
            <p>Output: "${result1}"</p>
            <br>
            <p><strong>Teste 2 (YYYYMMDD):</strong></p>
            <p>Input: "20251027"</p>
            <p>Output: "${result2}"</p>
            <br>
            <p><strong>Console:</strong> Abra o DevTools (F12) para ver logs detalhados</p>
        `;
    </script>
</body>
</html>

